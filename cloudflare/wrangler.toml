name = "wormish-current-time"
main = "src/index.ts"
compatibility_date = "2024-05-20"

[[durable_objects.bindings]]
name = "REGISTRY_ROOMS"
class_name = "RegistryRoomDurableObject"

[[migrations]]
tag = "v2"
new_sqlite_classes = ["RegistryRoomDurableObject"]

[vars]
ALLOWED_ORIGINS = "http://localhost:5173"

[[ratelimits]]
name = "RATE_LIMIT_CREATE"
namespace_id = "1001"
simple = { limit = 5, period = 60 }

[[ratelimits]]
name = "RATE_LIMIT_PUBLIC"
namespace_id = "1002"
simple = { limit = 5, period = 60 }

[[ratelimits]]
name = "RATE_LIMIT_JOIN_IP"
namespace_id = "1003"
simple = { limit = 10, period = 60 }

[[ratelimits]]
name = "RATE_LIMIT_JOIN_ROOM"
namespace_id = "1004"
simple = { limit = 10, period = 60 }

[[ratelimits]]
name = "RATE_LIMIT_POLL_ROOM"
namespace_id = "1005"
simple = { limit = 20, period = 10 }

[[ratelimits]]
name = "RATE_LIMIT_MUTATION_ROOM"
namespace_id = "1006"
simple = { limit = 40, period = 60 }

[env.production]
[[env.production.durable_objects.bindings]]
name = "REGISTRY_ROOMS"
class_name = "RegistryRoomDurableObject"

[[env.production.ratelimits]]
name = "RATE_LIMIT_CREATE"
namespace_id = "1001"
simple = { limit = 5, period = 60 }

[[env.production.ratelimits]]
name = "RATE_LIMIT_PUBLIC"
namespace_id = "1002"
simple = { limit = 5, period = 60 }

[[env.production.ratelimits]]
name = "RATE_LIMIT_JOIN_IP"
namespace_id = "1003"
simple = { limit = 10, period = 60 }

[[env.production.ratelimits]]
name = "RATE_LIMIT_JOIN_ROOM"
namespace_id = "1004"
simple = { limit = 10, period = 60 }

[[env.production.ratelimits]]
name = "RATE_LIMIT_POLL_ROOM"
namespace_id = "1005"
simple = { limit = 20, period = 10 }

[[env.production.ratelimits]]
name = "RATE_LIMIT_MUTATION_ROOM"
namespace_id = "1006"
simple = { limit = 40, period = 60 }

[env.production.vars]
ALLOWED_ORIGINS = "ALLOWED_ORIGIN_PLACEHOLDER"
